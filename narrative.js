// Announcement lines stored in a single string with delimiters
const narrativeLinesText = `
Neptune's Methane Fog reduces visibility, engine thrust and is high corrosive.|||
We believe there is an alien King and Queen and trying to gather more information.|||
We found some alien poetry: Zar'keth vri'shanu, thol'ka enar vo'vay, which means: Diamonds fall like the tears of stars, echoing creation and conquest. |||
We found some alien poetry: Qel'tara shen'vok, pul'shara vathen threk, which means: Energy pulses with the heart of conquered worlds, nurturing the birth of new life. |||
We found some alien poetry: K'rathun fesh'tar, gnar'kesh thol'dar, which means: Storms roar with ancient power, concealing the lost echoes of our kind. |||
We found some alien poetry: Zar'eth khaal, shen'qaroth nar'vahl, which means: Hunters glide through shadows, eyes set on those who challenge the night. |||
We found some alien poetry: T'karal vesh'dir, thal'voran vathok, which means: Magnetic tides twist our fate, bending reality to the will of the strong. |||
We found some alien poetry: Shak'varu, thal'kor en kash'tir, which means: The queen rises, merging with the core of our world, seeking dominion over all. |||
We found some alien poetry: Vresh'tok sarn'keth, a'larath thok'resh, which means: Frozen relics lie in wait, remnants of empires swallowed by the void. |||
We found some alien poetry: Qal'vath shesh'raal, qeth'rath vornash, which means: Temporal rifts shimmer, rewriting the history of the conquered and the conquerors. |||
We found some alien poetry: Nok'tara veth'kresh, ra'sharan eloth, which means: In liquid diamonds, dreams of conquest shine bright, a reflection of imperial desire. |||
We found some alien poetry: Rha'kul nar'zaar, thrin'karash voth'ral, which means: A hive-mind weaves its web, assimilating the brave into the fabric of its ambition. |||
In the void of Neptune, diamonds fall like treasures claimed, as empires stretch their grasp across uncharted realms.|||
The energy pods pulse like heartbeats of a conquered world, sustaining nests where new life is forged in imperial shadows.|||
Amidst the raging storms, echoes of ancient conquest whisper, telling tales of civilizations extinguished beneath the weight of ambition.|||
Hunters stalk their prey with calculated intent, the watchful eyes of an empire that sees all and spares none in its relentless pursuit.|||
Magnetic tides twist our path, bending navigation like the will of colonizers, reshaping lands to fit their vision of power.|||
The queen emerges from the depths, merging with the very core of Neptune, her imperial ambition radiating through the dark waters.|||
Frozen relics of the past lie entombed in ice, remnants of civilizations swallowed by the hunger of imperial expansion.|||
Temporal anomalies flicker, distorting time as empires rewrite history, erasing the footprints of those who stood against them.|||
In the depths of liquid diamonds, dreams of conquest shimmer, reflecting the greed that drives the engines of imperial ambition.|||
A hive-mind of conquerors weaves its web, a tapestry of domination, seeking to assimilate all who dare to defy its reach.|||
The Great Dark Spot looms, a harbinger of imperial might, cloaked in shadows that conceal the weapons of an unyielding force.|||
Amidst the swirling chaos, whispers of a subjugated world rise, beckoning us to uncover the truths hidden beneath the imperial yoke.|||
Quantum rifts shimmer like the borders of empires, linking worlds as conquerors stretch their ambitions across the stars.|||
The alien language flows like the tide of history, a symphony of conquest that resonates with the blood of the fallen.|||
Echoes of a forgotten war reverberate in the winds, tales of imperial conflict that reshaped the destinies of worlds forever.|||
Neptune’s storms roar with ancient fury, concealing the echoes of a civilization lost beneath layers of ice and gas.|||
Hunters glide through the tempest, their senses sharp, tracking the fleeting shadows of those who dare to challenge the skies.|||
Magnetic tides pull at our vessels, distorting reality, as we navigate the treacherous seas of the great blue planet.|||
The alien queen drifts like a phantom, merging with Neptune’s core, seeking power in the depths of the world she commands.|||
Frozen relics lie entombed in the icy grasp of time, remnants of battles fought in forgotten epochs, waiting to be unearthed.|||
Temporal anomalies flicker in the corners of perception, stretching moments into eternity, bending the very fabric of existence.|||
In the depths of Neptune’s ocean, liquid diamonds swirl, reflecting the fractured dreams of those who dared to dream beyond the stars.|||
A sentient hive-mind weaves through the air, a tapestry of thoughts and memories, longing to connect with the souls of the brave.|||
The Great Dark Spot pulses ominously, a harbinger of chaos cloaked in darkness, harboring weapons of unfathomable power.|||
Amidst the swirling storms, whispers of an ancient civilization beckon, inviting us to uncover the truths hidden beneath the chaos.|||
Quantum rifts shimmer in the shadows, linking worlds beyond our comprehension, offering glimpses of alternate destinies.|||
As we delve into the mysteries of the cosmos, the alien language dances before us, a symphony of mathematics and dreams.|||
The echoes of a forgotten war resonate in the winds, carrying the weight of ancient conflicts that shaped the fate of worlds.|||
Diamonds rain like whispers, a balance lost in voids.|||
Energy pods pulse bright, nurturing nests in shadowed depths.|||
Alien flora weaves the threads of life, birthing workers anew.|||
Storms swirl secrets, Neptune's heart beats cold and fierce.|||
Communication flickers, coded messages in the dark.|||
Great Dark Spot breathes, hiding weapons in its depths.|||
Hunters stalk the skies, their eyes set on distant prey.|||
Zappers hum a tune, disabling systems with their song.|||
Magnetic anomalies twist our paths, reality bending.|||
The queen's shadows loom, merging with the planet's core.|||
Nests pulse with life, a cycle of destruction and birth.|||
Frozen cities lie beneath, echoes of ancient battles.|||
Temporal rifts flicker, time dancing at the edge of chaos.|||
Energy surges pulse beneath the waves of liquid diamond.|||
An ancient AI awakens, its whispers rustling through the ice.|||
Harvesters gather gems, crafting tools for unknown ends.|||
Sentient storms rage, carrying the breath of the ancients.|||
Alien whispers float through the atmosphere, a haunting lullaby.|||
Quantum gates open, linking worlds in a tapestry of fate.|||
Neptune’s dark mysteries stir, secrets longing to be known.|||
The hive-mind awakens, a network of thoughts intertwined.|||
The meteor showers and diamond rain create a balance of destruction and creation that sustains Neptune's surface.|||
The red energy pods contain compressed Hydrogen that the aliens use to feed their Nests and spawn new aliens.|||
Our scientists have identified that the alien plants turn into Nests which spawn new aliens.|||
Our scientists have identified that Neptune diamond rain increases alien plant growth.|||
Neptune has magnetic anomalies that mess with our systems and invert our navigation controls.|||
Dark, cold, and whipped by supersonic winds, giant Neptune is the eighth and most distant major planet orbiting our Sun.|||
Neptune's temperature is -214 Celcius. It is the second coldest planet in our solar system.|||
Neptune's atmosphere is made up of mostly hydrogen and helium, with a small amount of methane.|||
We believe the aliens are preparing for their major attack on Earth.|||
Our scientists are detecting significant coded alien communications between Neptune and Earth.|||
There are fears that some human bases have been infiltrated by alien shapeshifters.|||
The appeasement faction think a NoFly zone might be a route to a peace deal with the aliens.|||
Our scientists think that the Alien Worm DNA might possess a special molecule.|||
Our scientists are trying to improve the guided missiles for remote strikes.|||
Our scientists are working to improve the Wingman Drone for fully autonomous assaults.|||
Our research suggests that the Alien Queen uses a high power repulsion shield.|||
Our research suggests that the Alien Queen's weak point is her inability to heal damage.|||
Our research has identified that the Alien Queen travels between planets seeding them with her plant spores.|||
The alien workers are collecting the red energy pods to bring them to their nests.|||
The alien plants turn into Nests which can spawn new alien workers.|||
Hunters are military caste of aliens that track our pilots.|||
Zappers are special aliens that can disable our energy systems.|||
Destroyers are special aliens that target our facilities.|||
Hunters are military caste of aliens that track our pilots.|||
Commander, the aliens have discovered a new way to harness Neptune's methane.|||
Our probes have detected unusual seismic activity on Neptune's moon Triton.|||
The alien ecosystem is evolving at an alarming rate.|||
Earth's last transmission was garbled.|||
Neptune's Great Dark Spot is expanding.|||
A rogue comet is headed for Neptune's orbit.|||
The alien language has been partially deciphered.|||
Our scientists are developing a new cryo-weapon.|||
Strange energy readings are emanating from Neptune's core.|||
The aliens are attempting to terraform Neptune's upper atmosphere.|||
A mutiny is brewing among the alien ranks.|||
Neptune's magnetic field is fluctuating wildly.|||
We've detected an ancient artifact buried deep in Neptune's ice layer.|||
The aliens are harvesting Neptune's diamonds for unknown purposes.|||
Our spies report the aliens are close to cracking the secret of cold fusion.|||
Neptune's rings are destabilizing.|||
The alien hive mind seems to be centered around a specific location.|||
Our deep space sensors have picked up an unknown signal.|||
The aliens have begun weaponising Neptune's intense winds.|||
A time anomaly has been detected near Triton.|||
The alien flora is producing a neurotoxin that affects human cognitive functions.|||
Neptune's axis tilt is changing.|||
We've lost contact with our base on Nereid.|||
The aliens are attempting to create a wormhole.|||
A new strain of alien has emerged, immune to our current weapons.|||
Neptune's ocean of super-hot water may hold the key to defeating the aliens.|||
The alien queen has been spotted.|||
Our scientists have discovered a way to communicate with Neptune itself.|||
The aliens are harvesting dark matter from Neptune's atmosphere.|||
A massive alien structure has been detected beneath Neptune's clouds.|||
The Great Dark Spot is actually an alien superweapon.|||
Neptune's moons are aligning in an unnatural pattern.|||
The aliens have developed organic ships that can withstand Neptune's crushing pressures.|||
A rogue AI from Earth has made contact.|||
The alien hivemind is attempting to assimilate human consciousness.|||
Neptune's core is becoming unstable.|||
The aliens are using quantum entanglement for instantaneous communication.|||
A dormant alien race has been discovered frozen in Neptune's methane ice.|||
The aliens are manipulating Neptune's magnetic field to create a planetary shield.|||
Our scientists have developed a way to weaponize Neptune's diamond rain.|||
The alien queen is attempting to merge with Neptune's core.|||
Neptune's rapid rotation is key to a new form of propulsion.|||
The aliens are using Neptune's aurora as a power source.|||
A temporal rift has opened near Neptune.|||
The aliens have created a super-soldier using DNA from Neptune's extremophile bacteria.|||
Neptune's storms are becoming sentient.|||
The alien hivemind is attempting to connect with similar entities on other gas giants.|||
Our deep space probes have detected an approaching alien armada.|||
The aliens are trying to shift Neptune's orbit.|||
A mysterious monolith has appeared on Triton.|||
The aliens have developed a way to "phase" through solid matter.|||
Neptune's methane is being converted into a psychoactive compound.|||
An ancient alien AI has awakened in Neptune's core.|||
The aliens are attempting to create a Dyson sphere around Neptune.|||
A massive creature has been spotted in Neptune's liquid diamond sea.|||
The aliens have unlocked the secret of cold fusion.|||
Neptune's magnetic field is creating natural wormholes.|||
The alien hivemind is fracturing.|||
Our scientists have found a way to communicate with Neptune's dark spots.|||
The aliens are using quantum tunneling to bypass our defenses.|||
A cosmic string has been detected near Neptune.|||
The aliens have created a device that can control Neptune's weather.|||
Neptune's core is generating an unknown form of energy.|||
The alien queen is attempting to merge with Neptune itself.|||
Our deep space sensors have detected a gamma-ray burst heading towards Neptune.|||
The aliens have developed organic ships that can withstand Neptune's extreme pressures.|||
A time capsule from Earth's future has appeared on Triton.|||
The aliens are using dark matter to create invisible structures.|||
Neptune's rings are actually a giant alien supercomputer.|||
The alien hivemind has begun to influence the dreams of our soldiers.|||
A giant space whale has been spotted in Neptune's atmosphere.|||
The aliens have created a sonic weapon that can shatter Neptune's ice caps.|||
Our scientists have found a way to weaponize Neptune's intense radio emissions.|||
The aliens are attempting to create a black hole at Neptune's core.|||
A new form of alien-human hybrid has emerged.|||
Neptune's magnetic field is generating a form of cosmic radiation that enhances human abilities.|||
The aliens have developed a virus that turns Neptune's methane into a corrosive acid.|||
An ancient alien temple has risen from Neptune's depths.|||
The alien queen is attempting to hijack our communication systems.|||
Our probes have detected a massive energy source at Neptune's south pole.|||
The aliens are using quantum entanglement to predict our every move.|||
Neptune's liquid diamond ocean is becoming sentient.|||
A solar flare has temporarily disabled the alien's defenses.|||
The aliens have created a device that can manipulate gravity.|||
Our scientists have developed a way to harness the power of Neptune's superionic water.|||
The alien hivemind is attempting to assimilate Neptune's moons.|||
A wormhole has opened near Triton, leading to an alternate version of Neptune.|||
The aliens are using Neptune's intense winds to power a doomsday device.|||
Our deep space sensors have detected an approaching object of impossible mass.|||
The aliens have unlocked the secret of transmuting elements.|||
Neptune's core is generating exotic matter.|||
The alien queen has challenged you to single combat.|||
Our scientists have found a way to communicate with parallel universes.|||
The aliens are attempting to freeze Neptune's core.|||
A cosmic being of pure energy has entered Neptune's orbit.|||
The aliens have created a device that can teleport entire continents.|||
Our probes have detected signs of a previous civilization deep within Neptune.|||
The alien hivemind is attempting to merge with Neptune's magnetosphere.|||
A mysterious crystal formation has been detected on Neptune's surface.|||
Our deep space radar has picked up an approaching alien armada.|||
The alien spores are mutating our equipment at an alarming rate.|||
Neptune's storms are forming unnatural geometric patterns.|||
We've lost contact with our outpost on Triton's southern pole.|||
The aliens have begun manipulating Neptune's gravitational field.|||
Our scientists have discovered a new element in Neptune's atmosphere.|||
Strange bio-luminescent creatures have been spotted in Neptune's clouds.|||
The alien hivemind is attempting to interface with our AI systems.|||
Neptune's core temperature is rising at an unprecedented rate.|||
We've detected an energy signature similar to a black hole near Neptune.|||
The aliens are constructing massive structures in Neptune's stratosphere.|||
Our probes have discovered an ancient alien city frozen in Neptune's ice.|||
The alien technology is causing quantum fluctuations in Neptune's orbit.|||
We've intercepted alien transmissions from beyond our solar system.|||
Neptune's magnetic poles are rapidly shifting.|||
The aliens have created a force field around one of Neptune's moons.|||
Our deep space telescopes have spotted an artificial megastructure near Neptune.|||
The alien virus is spreading through our water purification systems.|||
Neptune's rings are emitting an unknown form of radiation.|||
We've detected temporal anomalies near Neptune's equator.|||
The aliens are harvesting rare isotopes from Neptune's core.|||
Our scientists have discovered a way to weaponize Neptune's diamond rain.|||
The alien fleet is using Neptune's atmosphere as a cloaking device.|||
We've found evidence of an ancient interstellar war in Neptune's geological record.|||
The aliens are attempting to create a stable wormhole using Neptune's energy.|||
Neptune's thermal emissions are forming complex, possibly coded patterns.|||
Our deep space probes have detected a massive object approaching Neptune.|||
The alien technology is causing unpredictable quantum effects in Neptune's vicinity.|||
We've discovered an alien artifact that can manipulate Neptune's weather patterns.|||
The aliens are using Neptune's magnetic field to power a mysterious device.|||
Our sensors have detected a series of subspace ruptures around Neptune's orbit.|||
The alien winds of Neptune carry whispers of an ancient civilization.|||
Our probes have detected unusual gravitational anomalies in the Great Dark Spot.|||
Neptune's storms rage on, concealing secrets beneath layers of gas and ice.|||
The alien hive-mind communicates through complex electromagnetic pulses.|||
We've intercepted an alien transmission containing mathematical sequences beyond our understanding.|||
Strange crystalline structures on Triton suggest evidence of extraterrestrial mining operations.|||
Our scientists have discovered Neptune emits low-frequency radio waves in regular patterns.|||
The alien fleet approaches, their ships utilizing advanced stealth technology.|||
Neptune's core pulses with energy, potentially powering the alien civilization.|||
We've detected quantum fluctuations that may be the key to interstellar travel.|||
The alien ecosystem evolves rapidly, adapting to Neptune's harsh conditions.|||
Our deep space sensors have picked up signals from beyond our solar system.|||
The aliens are attempting to harness the power of Neptune's intense magnetic field.|||
We've lost contact with our outpost on Nereid; rescue mission is being prepared.|||
The alien language appears to be based on complex multidimensional mathematics.|||
Neptune's magnetic field fluctuations could be used to generate immense power.|||
Our spies report the aliens have developed a way to manipulate gravity itself.|||
A rogue comet approaching Neptune's orbit contains traces of alien technology.|||
We've detected an ancient artifact that may hold the secrets of faster-than-light travel.|||
The aliens are using Neptune's atmosphere to synthesize exotic materials.|||
Our scientists have developed a prototype weapon utilizing Neptune's extreme pressures.|||
Neptune's rings are exhibiting unusual patterns, possibly due to alien interference.|||
The alien leadership structure appears to be based on a complex caste system.|||
We've discovered that certain frequencies disrupt the aliens' neural networks.|||
The time anomaly near Triton is causing localized areas of accelerated time dilation.|||
Our deep space probes have detected a massive object of artificial origin approaching Neptune.|||
The aliens are attempting to create a stable wormhole using Neptune's core as an anchor point.|||
Neptune's axial tilt is changing, potentially due to large-scale alien engineering projects.|||
We've found evidence that the aliens have been observing Earth for millennia.|||
The Great Dark Spot may be concealing a massive alien installation.|||
Our scientists have discovered a way to use Neptune's diamond rain as a power source.|||
Our quantum entanglement communicator has detected a parallel universe Neptune.|||
Alien nanobots are reconstructing Neptune's atmosphere at the molecular level.|||
We've discovered a way to utilize Neptune's metallic hydrogen as a superconductor.|||
The alien civilization appears to exist in multiple dimensions simultaneously.|||
Our probes have detected signs of a Dyson sphere being constructed around Neptune.|||
The aliens are harvesting antimatter from Neptune's magnetosphere.|||
We've intercepted transmissions suggesting the aliens are fleeing a galactic threat.|||
Neptune's core is emitting tachyon particles, indicating potential time manipulation.|||
Our scientists have developed a gravity manipulation device based on alien technology.|||
The alien fleet is powered by zero-point energy extracted from Neptune's quantum foam.|||
We've detected signs of a dormant AI within Neptune's ice giants.|||
The aliens are using dark matter to cloak their movements around Neptune.|||
Our deep space telescopes have spotted a potential wormhole near Neptune's orbit.|||
Neptune's storms are being used to generate plasma weapons of immense power.|||
We've discovered alien biomechanical implants that allow survival in Neptune's atmosphere.|||
The alien language contains mathematical proofs for solving currently unsolvable problems.|||
Our sensors have detected a massive energy signature beneath Neptune's surface.|||
The aliens are using quantum tunneling to move freely through Neptune's dense layers.|||
We've found evidence of an ancient alien war fought in Neptune's orbit.|||
Neptune's magnetic field is being used to power a planet-wide force field.|||
Our scientists have cracked the code to alien faster-than-light communication.|||
The aliens are terraforming one of Neptune's moons using advanced nanotechnology.|||
We've detected signs of a space-time anomaly at Neptune's core.|||
The alien civilization has mastered cold fusion using Neptune's abundant deuterium.|||
Our probes have discovered a hidden network of wormholes around Neptune.|||
Neptune's rings are actually a swarm of microscopic alien probes.|||
We've intercepted plans for an alien megastructure that spans Neptune's orbit.|||
The aliens are using quantum entanglement to instantly transport matter across vast distances.|||
Our deep space radar has detected a cloaked alien mothership in Neptune's Lagrange point.|||
Neptune's atmosphere contains spores of an alien organism with incredible healing properties.|||
We've discovered alien technology capable of manipulating the strong nuclear force.|||
The aliens have created a Bose-Einstein condensate at Neptune's core for unknown purposes.|||
Our scientists have developed a way to tap into the alien's psychic network.|||
Neptune's moons are revealed to be ancient alien space stations in disguise.|||
We've detected signs of a subspace beacon emanating from deep within Neptune.|||
The aliens are using Neptune's magnetic field to broadcast messages across the galaxy.|||
Our probes have discovered an alien artifact that can manipulate probability itself.|||
Neptune's Great Dark Spot is actually a gateway to another dimension.|||
We've intercepted alien plans to move Neptune out of its orbit.|||
The alien civilization exists primarily in a virtual reality powered by Neptune's core.|||
Our sensors have detected signs of time dilation near alien structures on Triton.|||
The aliens are harvesting exotic particles from Neptune's upper atmosphere.|||
We've discovered a way to use Neptune's storms to generate holographic camouflage.|||
Neptune's core contains an alien supercomputer of unimaginable processing power.|||
Our scientists have created a prototype drive utilizing Neptune's differential rotation.|||
The aliens are using quantum locking to create indestructible materials.|||
We've detected signs of a Kardashev Type III civilization observing Neptune.|||
Neptune's magnetic field fluctuations are actually an alien form of art.|||
Our deep space probes have discovered an alien megastructure enclosing Neptune's orbit.|||
The aliens have developed a way to harness the power of virtual particles.|||
We've intercepted transmissions suggesting the aliens are engaged in stellar engineering.|||
Neptune's atmosphere contains alien nanomachines that are slowly transforming the planet.|||
Our scientists have discovered a way to use Neptune's differential rotation for time travel.|||
The aliens are using quantum superposition to exist in multiple places simultaneously.|||
We've detected signs of an artificial magnetosphere being constructed around Neptune.|||
Neptune's core is actually an ancient alien AI hibernating for millennia.|||
Our probes have discovered alien technology capable of manipulating dark energy.|||
The aliens are using Neptune as a giant quantum computer.|||
We've intercepted plans for an alien device that can control gravity waves.|||
Neptune's storms are being used to generate exotic matter.|||
Our scientists have developed a prototype telepathic interface based on alien biology.|||
The aliens have created a stable wormhole at Neptune's core.|||
We've detected signs of a massive alien fleet in cryogenic stasis orbiting Neptune.|||
Neptune's magnetic field is being used to power a planet-wide cloaking device.|||
Our deep space sensors have detected a Dyson swarm under construction around Neptune.|||
The aliens are using quantum entanglement to create an instantaneous defense network.|||
We've discovered alien technology capable of manipulating the fabric of space-time.|||
Neptune's atmosphere contains alien microorganisms with incredible computational abilities.|||
Our probes have detected signs of a matrioshka brain being constructed within Neptune.|||
The aliens have developed a way to extract usable energy from Neptune's thermal gradient.|||
We've intercepted transmissions suggesting the aliens are engaged in galactic-scale engineering.|||
Neptune's core contains an alien artifact that can predict future events.|||
Our scientists have created a prototype matter transmitter using alien principles.|||
The aliens are using Neptune's magnetic field to generate artificial gravity.|||
We've detected signs of a massive alien arcology hidden beneath Neptune's clouds.|||
Neptune's rings are actually a dispersed alien superweapon.|||
Our deep space telescopes have spotted an alien megastructure approaching Neptune's orbit.|||
The aliens have developed a way to manipulate subatomic particles to create new elements.|||
We've discovered alien technology capable of altering the laws of physics locally.|||
Neptune's atmosphere is being used as a massive alien data storage system.|||
Our scientists have developed a prototype consciousness transfer device based on alien tech.|||
The aliens are using quantum tunneling to mine resources from Neptune's core.|||
We've detected signs of a galactic communications network centered on Neptune.|||
Neptune's magnetic field fluctuations are actually an alien form of faster-than-light propulsion.|||
Our probes have discovered an alien time capsule orbiting Neptune.|||
The aliens have created a stable Einstein-Rosen bridge in Neptune's upper atmosphere.|||
We've intercepted plans for an alien device that can manipulate the cosmic microwave background.|||
Neptune's core contains an alien superweapon capable of destroying entire star systems.|||
Our scientists have developed a way to tap into the alien's collective consciousness.|||
The aliens are using Neptune's differential rotation to power a time dilation field.|||
We've detected signs of an alien construct capable of moving entire planets.|||
Neptune's storms are being used to generate a form of programmable matter.|||
Our deep space sensors have detected a fleet of Von Neumann probes approaching Neptune.|||
The aliens have developed a way to harness vacuum energy on a planetary scale.|||
We've discovered alien technology capable of manipulating quantum states across vast distances.|||
Neptune's atmosphere contains alien nanobots that are slowly transforming it into a computer.|||
Our probes have detected signs of a Planck-scale alien civilization living within Neptune's quantum foam.|||
The aliens are using Neptune as a giant transmitter for faster-than-light communication.|||
We've intercepted plans for an alien device that can create stable micro black holes.|||
Alien ships have been spotted over major cities worldwide.|||
The United Nations has declared a global state of emergency.|||
Massive electromagnetic pulses have disabled Earth's power grids.|||
Alien ground forces have landed in the Siberian tundra.|||
World leaders are being evacuated to underground bunkers.|||
The aliens have established a beachhead in the Amazon rainforest.|||
Earth's satellite networks have been completely disabled.|||
Alien craft are extracting large quantities of seawater from the Pacific.|||
A giant mothership has taken position over the North Pole.|||
The aliens have broadcast an ultimatum in all Earth languages.|||
Reports of mass abductions are flooding in from rural areas.|||
Alien terraforming machines have landed in the Sahara Desert.|||
Earth's militaries are mobilizing for a coordinated counterattack.|||
The aliens have neutralized all nuclear weapons simultaneously.|||
A massive alien structure is being assembled in Earth's orbit.|||
Alien spores are rapidly altering Earth's atmosphere.|||
The world's governments have initiated the Doomsday Protocol.|||
Alien walkers are decimating major military installations.|||
Earth's oceans are receding at an alarming rate due to alien harvesting.|||
The aliens have established a quantum entanglement network around the planet.|||
Reports of humans being converted into alien hybrids are increasing.|||
The aliens have initiated a controlled demolition of Earth's moon.|||
Earth's magnetic field is being disrupted by alien technology.|||
Alien mind control signals are being broadcast globally.|||
The Svalbard Global Seed Vault has been breached by alien forces.|||
Alien nanobots are rapidly consuming Earth's infrastructure.|||
A second alien faction has arrived, engaging the first in orbit.|||
The aliens have accelerated global warming to reshape Earth's climate.|||
Earth's rotation is slowing due to alien gravitational technology.|||
Alien forces have taken control of the International Space Station.|||
The world's internet infrastructure has been co-opted by alien AI.|||
Alien bioweapons are causing rapid mutations in Earth's fauna.|||
The aliens have initiated a mass scan of all human minds.|||
Earth's core is being destabilized by alien drilling operations.|||
Alien replicators are converting Earth's biomass at an exponential rate.|||
The aliens have erected an energy shield around the entire planet.|||
Reports of time distortions are coming in from alien-occupied zones.|||
The aliens are redirecting asteroids towards Earth as a show of force.|||
Earth's atmosphere is being stripped away by alien harvesting ships.|||
Alien forces have taken control of all Earth's nuclear facilities.|||
The aliens have initiated a global weather control system.|||
Earth's governments are surrendering one by one to the alien ultimatum.|||
Alien terraforming has turned the Amazonian rainforest into a massive hive.|||
The aliens have demonstrated the ability to manipulate tectonic plates.|||
A massive alien artifact has emerged from beneath the Pacific Ocean.|||
The aliens are using human prisoners as living batteries.|||
Earth's moon has been converted into an alien command center.|||
Alien ships are extracting rare earth elements at an unsustainable rate.|||
The aliens have seeded Earth's stratosphere with mind-altering chemicals.|||
A giant alien AI has taken control of Earth's remaining digital infrastructure.|||
The aliens are constructing massive arcologies over major Earth cities.|||
Earth's militaries have been reduced to guerrilla resistance groups.|||
The aliens have initiated a selective breeding program for humans.|||
Alien technology is causing widespread genetic mutations in newborns.|||
The aliens have begun the process of disassembling Mars for resources.|||
Earth's orbit is being altered by alien gravitational technology.|||
The aliens have released a virus that turns humans into mindless drones.|||
Alien forces have established underwater bases in Earth's oceans.|||
The aliens are using Earth as a battleground in an interstellar war.|||
Earth's plant life is rapidly being replaced by alien flora.|||
The aliens have constructed a space elevator in the Pacific Ocean.|||
Alien psychic attacks have incapacitated a third of Earth's population.|||
The aliens are converting Earth's atmosphere to match their home world.|||
Earth's governments have agreed to conditional surrender terms.|||
Alien ships are appearing and disappearing, suggesting time travel capabilities.|||
The aliens have initiated a forced evolutionary acceleration of humanity.|||
Earth's magnetic poles are rapidly shifting due to alien interference.|||
The aliens have created a global surveillance network using nanodrones.|||
Alien forces have taken control of Earth's major fresh water sources.|||
The aliens are harvesting human emotions as an energy source.|||
Earth's cloud formations are being used to spell out alien messages.|||
Alien technology has rendered all of Earth's weapons systems useless.|||
The aliens have begun large-scale human experimentation programs.|||
Earth's tides have become erratic due to alien manipulation of the moon.|||
The aliens have released self-replicating machines to convert Earth's cities.|||
Alien ships are using Earth's upper atmosphere as a fusion reactor.|||
The aliens have initiated a mass upload of human consciousness.|||
Earth's core is being cooled by alien technology, weakening its magnetic field.|||
Alien forces have established a quarantine field around Earth.|||
The aliens are rewriting human history through mass memory manipulation.|||
Earth's oceans are being seeded with alien microorganisms.|||
The aliens have constructed massive energy collectors in Earth's deserts.|||
Alien ships are creating artificial auroras as a form of communication.|||
The aliens have initiated a controlled break-up of Earth's tectonic plates.|||
Earth's orbit is being used as a particle accelerator by alien scientists.|||
Alien forces have taken control of Earth's weather satellite network.|||
The aliens are using human dreams as a form of faster-than-light communication.|||
Earth's forests are being converted into alien biocomputers.|||
The aliens have begun construction of a Dyson swarm around the Sun.|||
Alien technology is causing spontaneous human combustion worldwide.|||
Earth's governments are being replaced by alien AI administrators.|||
The aliens have initiated a planet-wide mindwipe of the human population.|||
Alien ships are creating artificial constellations in Earth's night sky.|||
The aliens are using Earth's core as a power source for interstellar travel.|||
Earth's gravity is fluctuating wildly due to alien experimentation.|||
Alien forces have established a global network of interdimensional portals.|||
The aliens have begun the process of transforming Earth into a spaceship.|||
Earth's atmosphere is being used as a massive alien data storage system.|||
Alien technology is causing the rapid evolution of Earth's insects.|||
The aliens have initiated a mass relocation of Earth's population.|||
We are gathering information on a massive alien mothership that has recently been detected.
`;

// Convert the text to an array of lines
const narrativeLines = narrativeLinesText
  .trim()
  .split("|||")
  .map((line) => line.trim());

let unusedLines = [...narrativeLines];

function setupNarrativeSystem() {
  initializeNarrativeSystem();
}

function initializeNarrativeSystem() {
  GameTimer.create("narrativeAnnouncement", announceRandomLine, 60000, true);
  //console.log('narrative system initalised');
}

function announceRandomLine() {
  if (unusedLines.length === 0) {
    unusedLines = [...narrativeLines];
  }
  const randomIndex = Math.floor(Math.random() * unusedLines.length);
  const lineToAnnounce = unusedLines[randomIndex];
  unusedLines.splice(randomIndex, 1);

  announcer.speak(lineToAnnounce, 18, 1);
}

class Announcement {
  constructor() {
    this.synthesis = window.speechSynthesis;
    this.voices = [];
    this.currentVoice = null;
    this.queue = [];
    this.maxQueueSize = 30;
    this.delayedAnnouncements = [];
    this.state = 'idle';
    this.currentUtterance = null;
    this.volume = 1.0;
    this.rate = 1.0;
    this.pitch = 1.0;
    
    // New properties for better state management
    this.isInitialized = false;
    this.queueProcessorId = null;
    this.maxRetries = 3;
    
    this.initialize().catch(error => 
      console.error('Failed to initialize Announcement:', error)
    );
  }

  async initialize() {
    if (this.isInitialized) {
      return;
    }

    try {
      await this.loadVoices();
      this.startQueueProcessor();
      this.isInitialized = true;
    } catch (error) {
      this.isInitialized = false;
      throw error;
    }
  }

  async loadVoices() {
    return new Promise((resolve, reject) => {
      const loadAttempt = () => {
        this.voices = this.synthesis.getVoices();
        
        if (this.voices.length > 0) {
          this.currentVoice = this.voices[0];
          console.log(`Loaded ${this.voices.length} voices`);
          resolve(this.voices);
        } else {
          setTimeout(loadAttempt, 100);
        }
      };

      // Add timeout to prevent infinite loading
      const timeout = setTimeout(() => {
        reject(new Error('Voice loading timed out'));
      }, 5000);

      loadAttempt();

      // Clear timeout if voices load successfully
      this.synthesis.onvoiceschanged = () => {
        clearTimeout(timeout);
        loadAttempt();
      };
    });
  }

  speak(text, voiceIndex = 0, priority = 0, delay = 0) {
    if (!this.isInitialized) {
      console.warn('Announcement system not initialized');
      return false;
    }

    if (!text) {
      console.warn('Empty text provided to speak method');
      return false;
    }

    // Validate voice index
    const validVoiceIndex = Math.max(0, Math.min(voiceIndex, this.voices.length - 1));
    const selectedVoice = this.voices[validVoiceIndex] || this.currentVoice;

    const announcement = {
      text,
      voice: selectedVoice,
      priority: Math.max(0, Math.min(priority, 2)), // Clamp priority between 0-2
      createdAt: Date.now(),
      retryCount: 0
    };

    if (delay > 0) {
      this.scheduleAnnouncement(announcement, delay);
    } else {
      this.addToQueue(announcement);
    }

    return true;
  }

  scheduleAnnouncement(announcement, delay) {
    const timerId = `announcement_${Date.now()}`;
    const scheduledTime = Date.now() + delay;
    
    const delayed = {
      announcement,
      timerId,
      scheduledTime,
      timeoutId: setTimeout(() => {
        this.handleDelayedAnnouncement(timerId, announcement);
      }, delay)
    };
    
    this.delayedAnnouncements.push(delayed);
  }

  handleDelayedAnnouncement(timerId, announcement) {
    // Remove from delayed queue
    const delayedAnn = this.delayedAnnouncements.find(da => da.timerId === timerId);
    if (delayedAnn) {
      clearTimeout(delayedAnn.timeoutId);
      this.delayedAnnouncements = this.delayedAnnouncements.filter(
        da => da.timerId !== timerId
      );
    }

    if (announcement.priority === 2) {
      this.queue.unshift(announcement);
    } else {
      this.addToQueue(announcement);
    }
    
    this.processNextAnnouncement();
  }

  addToQueue(announcement) {
    const index = this.queue.findIndex(a => a.priority < announcement.priority);
    if (index === -1) {
      this.queue.push(announcement);
    } else {
      this.queue.splice(index, 0, announcement);
    }

    if (this.queue.length > this.maxQueueSize) {
      this.queue.pop();
    }

    this.processNextAnnouncement();
  }

  processNextAnnouncement() {
    if (!this.isInitialized || 
        this.synthesis.speaking || 
        this.state !== 'idle' || 
        this.queue.length === 0) {
      return;
    }

    const announcement = this.queue.shift();
    if (announcement) {
      try {
        const utterance = new SpeechSynthesisUtterance(announcement.text);
        utterance.volume = this.volume;
        utterance.rate = this.rate;
        utterance.pitch = this.pitch;
        utterance.voice = announcement.voice;

        utterance.onstart = () => {
          this.state = 'speaking';
          //console.log(`Starting announcement: ${announcement.text}`);
        };

        utterance.onend = () => {
          this.state = 'idle';
          this.currentUtterance = null;
          this.processNextAnnouncement();
        };

        utterance.onerror = (event) => {
          console.error('Speech error:', event.error);
          this.handleSpeechError(announcement, event);
        };

        this.currentUtterance = utterance;
        this.synthesis.speak(utterance);
      } catch (error) {
        console.error('Failed to create utterance:', error);
        this.handleSpeechError(announcement, { error: 'utterance-creation-failed' });
      }
    }
  }

  handleSpeechError(announcement, event) {
    if (announcement.retryCount < this.maxRetries) {
      announcement.retryCount++;
      console.log(`Retrying announcement (attempt ${announcement.retryCount})`);
      this.queue.unshift(announcement);
    } else {
      console.error(`Failed to speak announcement after ${this.maxRetries} attempts`);
    }

    this.state = 'idle';
    this.currentUtterance = null;
    this.processNextAnnouncement();
  }

  startQueueProcessor() {
    // Clear any existing interval
    if (this.queueProcessorId) {
      clearInterval(this.queueProcessorId);
    }

    this.queueProcessorId = setInterval(() => {
      const now = Date.now();
      const readyAnnouncements = this.delayedAnnouncements.filter(
        da => now >= da.scheduledTime
      );

      readyAnnouncements.forEach(({ announcement, timeoutId }) => {
        clearTimeout(timeoutId); // Clear the timeout
        if (announcement.priority === 2) {
          this.queue.unshift(announcement);
        } else {
          this.addToQueue(announcement);
        }
      });

      this.delayedAnnouncements = this.delayedAnnouncements.filter(
        da => now < da.scheduledTime
      );

      if (readyAnnouncements.length > 0) {
        this.processNextAnnouncement();
      }
    }, 1000);
  }

  // New cleanup method
  dispose() {
    if (this.queueProcessorId) {
      clearInterval(this.queueProcessorId);
    }
    
    // Clear all delayed announcement timeouts
    this.delayedAnnouncements.forEach(da => {
      if (da.timeoutId) {
        clearTimeout(da.timeoutId);
      }
    });

    // Clear queues
    this.queue = [];
    this.delayedAnnouncements = [];
    
    // Cancel current speech
    if (this.synthesis.speaking) {
      this.synthesis.cancel();
    }
    
    //this.isInitialized = false;
  }
}




class GameTimer {
  static timers = {};
  static isPaused = false;

  constructor(key, callback, delay, repeat = false) {
    this.key = key;
    this.callback = callback;
    this.delay = delay;
    this.repeat = repeat;
    this.timeRemaining = delay;
    this.lastTime = Date.now();
    this.isActive = true;
    //console.log(`Timer constructed: ${key}`); // Debug log
  }

  static update() {
    if (GameTimer.isPaused) return;
    const currentTime = Date.now();
    Object.keys(GameTimer.timers).forEach((key) => {
      const timer = GameTimer.timers[key];
      if (timer.isActive) {
        const deltaTime = currentTime - timer.lastTime;
        timer.timeRemaining -= deltaTime;
        if (timer.timeRemaining <= 0) {
          //console.log(`Timer triggered: ${key}`); // Debug log
          timer.callback();
          if (timer.repeat) {
            timer.timeRemaining = timer.delay;
            //console.log(`Timer reset: ${key}`); // Debug log
          } else {
            timer.isActive = false;
            delete GameTimer.timers[key];
            //console.log(`Timer removed: ${key}`); // Debug log
          }
        }
        timer.lastTime = currentTime;
      }
    });
  }

  static create(key, callback, delay, repeat = false) {
    if (GameTimer.timers[key]) {
      //console.log(`Existing timer cleared: ${key}`); // Debug log
      GameTimer.clearTimer(key);
    }
    const timer = new GameTimer(key, callback, delay, repeat);
    GameTimer.timers[key] = timer;
    //console.log(`Timer created: ${key}`); // Debug log
    return timer;
  }

  static get(key) {
    return GameTimer.timers[key];
  }

  static exists(key) {
    return !!GameTimer.timers[key] && GameTimer.timers[key].isActive;
  }

  static clearTimer(key) {
    if (GameTimer.timers[key]) {
      GameTimer.timers[key].isActive = false;
      delete GameTimer.timers[key];
      debug.log(`Timer cleared: ${key}`); // Debug log
    }
  }

  static getTimeRemaining(key) {
    const timer = GameTimer.timers[key];
    if (timer && timer.isActive) {
      return timer.timeRemaining;
    }
    return 0;
  }

  static clearAllTimers() {
    const timerCount = Object.keys(GameTimer.timers).length;
    GameTimer.timers = {};
    debug.log(`All timers cleared. Count: ${timerCount}`); // Debug log
  }

  static pauseAll() {
    GameTimer.isPaused = true;
    debug.log("All timers paused"); // Debug log
  }

  static resumeAll() {
    GameTimer.isPaused = false;
    const currentTime = Date.now();
    Object.values(GameTimer.timers).forEach((timer) => {
      timer.lastTime = currentTime;
    });
    debug.log("All timers resumed"); // Debug log
  }

  static getActiveTimers() {
    const activeTimers = Object.entries(GameTimer.timers)
      .filter(([_, timer]) => timer.isActive)
      .map(([_, timer]) => ({
        key: timer.key,
        delay: timer.delay,
        timeRemaining: timer.timeRemaining,
      }));
    debug.log(`Active timers count: ${activeTimers.length}`); // Debug log
    return activeTimers;
  }

  pause() {
    this.isActive = false;
    console.log(`Timer paused: ${this.key}`); // Debug log
  }

  resume() {
    this.isActive = true;
    this.lastTime = Date.now();
    console.log(`Timer resumed: ${this.key}`); // Debug log
  }

  reset() {
    this.timeRemaining = this.delay;
    this.lastTime = Date.now();
    console.log(`Timer reset: ${this.key}`); // Debug log
  }
  static serializeTimers() {
    const serializedTimers = {};
    Object.entries(GameTimer.timers).forEach(([key, timer]) => {
      serializedTimers[key] = {
        delay: timer.delay,
        repeat: timer.repeat,
        timeRemaining: timer.timeRemaining,
        isActive: timer.isActive,
      };
    });
    return serializedTimers;
  }

  static deserializeTimers(timerData) {
    GameTimer.clearAllTimers(); // Clear existing timers before loading
    Object.entries(timerData).forEach(([key, data]) => {
      const timer = new GameTimer(key, () => {}, data.delay, data.repeat);
      timer.timeRemaining = data.timeRemaining;
      timer.isActive = data.isActive;
      GameTimer.timers[key] = timer;
    });
  }

  static getTimerState(key) {
    const timer = GameTimer.timers[key];
    if (timer) {
      return {
        delay: timer.delay,
        repeat: timer.repeat,
        timeRemaining: timer.timeRemaining,
        isActive: timer.isActive,
      };
    }
    return null;
  }
}
